"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.validateLock = exports.updateLock = exports.lockData = void 0;
var parsers_1 = require("@yarnpkg/parsers");
var fs_1 = require("fs");
var lockHeader = "\n# THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n# DevScript lockfile v1\n\n\n".replace(/^\n+/g, "");
exports.lockData = fs_1.existsSync("devscript.lock")
    ? parsers_1.parseSyml(fs_1.readFileSync("devscript.lock", "utf8"))
    : {};
function updateLock() {
    if (!parsers_1.stringifySyml(exports.lockData) && !fs_1.existsSync("devscript.lock"))
        return;
    fs_1.writeFileSync("devscript.lock", lockHeader + parsers_1.stringifySyml(exports.lockData));
}
exports.updateLock = updateLock;
function validateLock(dependencies, devDependencies) {
    var updated = false;
    Object.keys(exports.lockData).forEach(function (dep) {
        if (!Object.keys(dependencies)
            .concat(Object.keys(devDependencies))
            .includes(dep)) {
            delete exports.lockData[dep];
            updated = true;
        }
    });
    if (updated)
        updateLock();
}
exports.validateLock = validateLock;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9ja0hhbmRsZXIuanMiLCJzb3VyY2VSb290IjoiLi8iLCJzb3VyY2VzIjpbInV0aWwvbG9ja0hhbmRsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNENBQTREO0FBQzVELHlCQUE2RDtBQUU3RCxJQUFNLFVBQVUsR0FBRyxtR0FLbEIsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBRVosUUFBQSxRQUFRLEdBS2YsZUFBVSxDQUFDLGdCQUFnQixDQUFDO0lBQy9CLENBQUMsQ0FBQyxtQkFBUyxDQUFDLGlCQUFZLENBQUMsZ0JBQWdCLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDbkQsQ0FBQyxDQUFDLEVBQUUsQ0FBQztBQUVOLFNBQWdCLFVBQVU7SUFDekIsSUFBSSxDQUFDLHVCQUFhLENBQUMsZ0JBQVEsQ0FBQyxJQUFJLENBQUMsZUFBVSxDQUFDLGdCQUFnQixDQUFDO1FBQUUsT0FBTztJQUN0RSxrQkFBYSxDQUFDLGdCQUFnQixFQUFFLFVBQVUsR0FBRyx1QkFBYSxDQUFDLGdCQUFRLENBQUMsQ0FBQyxDQUFDO0FBQ3ZFLENBQUM7QUFIRCxnQ0FHQztBQUVELFNBQWdCLFlBQVksQ0FDM0IsWUFFQyxFQUNELGVBRUM7SUFFRCxJQUFJLE9BQU8sR0FBRyxLQUFLLENBQUM7SUFDcEIsTUFBTSxDQUFDLElBQUksQ0FBQyxnQkFBUSxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQUMsR0FBRztRQUNqQyxJQUNDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUM7YUFDeEIsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUM7YUFDcEMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxFQUNkO1lBQ0QsT0FBTyxnQkFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ3JCLE9BQU8sR0FBRyxJQUFJLENBQUM7U0FDZjtJQUNGLENBQUMsQ0FBQyxDQUFDO0lBQ0gsSUFBSSxPQUFPO1FBQUUsVUFBVSxFQUFFLENBQUM7QUFDM0IsQ0FBQztBQXBCRCxvQ0FvQkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwYXJzZVN5bWwsIHN0cmluZ2lmeVN5bWwgfSBmcm9tIFwiQHlhcm5wa2cvcGFyc2Vyc1wiO1xyXG5pbXBvcnQgeyBleGlzdHNTeW5jLCByZWFkRmlsZVN5bmMsIHdyaXRlRmlsZVN5bmMgfSBmcm9tIFwiZnNcIjtcclxuXHJcbmNvbnN0IGxvY2tIZWFkZXIgPSBgXHJcbiMgVEhJUyBJUyBBTiBBVVRPR0VORVJBVEVEIEZJTEUuIERPIE5PVCBFRElUIFRISVMgRklMRSBESVJFQ1RMWS5cclxuIyBEZXZTY3JpcHQgbG9ja2ZpbGUgdjFcclxuXHJcblxyXG5gLnJlcGxhY2UoL15cXG4rL2csIGBgKTtcclxuXHJcbmV4cG9ydCBsZXQgbG9ja0RhdGE6IHtcclxuXHRba2V5OiBzdHJpbmddOiB7XHJcblx0XHR2ZXJzaW9uOiBzdHJpbmc7XHJcblx0XHRpZ25vcmVVbnRpbE5leHQ6IFwiTUFKT1JcIiB8IFwiTUlOT1JcIiB8IFwiUEFUQ0hcIjtcclxuXHR9O1xyXG59ID0gZXhpc3RzU3luYyhcImRldnNjcmlwdC5sb2NrXCIpXHJcblx0PyBwYXJzZVN5bWwocmVhZEZpbGVTeW5jKFwiZGV2c2NyaXB0LmxvY2tcIiwgXCJ1dGY4XCIpKVxyXG5cdDoge307XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlTG9jaygpIHtcclxuXHRpZiAoIXN0cmluZ2lmeVN5bWwobG9ja0RhdGEpICYmICFleGlzdHNTeW5jKFwiZGV2c2NyaXB0LmxvY2tcIikpIHJldHVybjtcclxuXHR3cml0ZUZpbGVTeW5jKFwiZGV2c2NyaXB0LmxvY2tcIiwgbG9ja0hlYWRlciArIHN0cmluZ2lmeVN5bWwobG9ja0RhdGEpKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlTG9jayhcclxuXHRkZXBlbmRlbmNpZXM6IHtcclxuXHRcdFtuYW1lOiBzdHJpbmddOiBzdHJpbmc7XHJcblx0fSxcclxuXHRkZXZEZXBlbmRlbmNpZXM6IHtcclxuXHRcdFtuYW1lOiBzdHJpbmddOiBzdHJpbmc7XHJcblx0fVxyXG4pIHtcclxuXHRsZXQgdXBkYXRlZCA9IGZhbHNlO1xyXG5cdE9iamVjdC5rZXlzKGxvY2tEYXRhKS5mb3JFYWNoKChkZXApID0+IHtcclxuXHRcdGlmIChcclxuXHRcdFx0IU9iamVjdC5rZXlzKGRlcGVuZGVuY2llcylcclxuXHRcdFx0XHQuY29uY2F0KE9iamVjdC5rZXlzKGRldkRlcGVuZGVuY2llcykpXHJcblx0XHRcdFx0LmluY2x1ZGVzKGRlcClcclxuXHRcdCkge1xyXG5cdFx0XHRkZWxldGUgbG9ja0RhdGFbZGVwXTtcclxuXHRcdFx0dXBkYXRlZCA9IHRydWU7XHJcblx0XHR9XHJcblx0fSk7XHJcblx0aWYgKHVwZGF0ZWQpIHVwZGF0ZUxvY2soKTtcclxufVxyXG4iXX0=